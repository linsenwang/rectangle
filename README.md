# Rectangle 风格 Hammerspoon 窗口管理器

一个功能丰富的 macOS 窗口管理配置，基于 Hammerspoon 实现，灵感来源于 Rectangle Pro。

## 安装

1. 安装 [Hammerspoon](https://www.hammerspoon.org/)
2. 将 `hammerspoon/init.lua` 复制到 `~/.hammerspoon/`
3. 重新加载 Hammerspoon 配置

## 快捷键

主修饰键：`Ctrl + Option` (⌃⌥)

### 基础窗口管理

| 快捷键 | 功能 |
|--------|------|
| `⌃⌥ ←` | 左半屏 (循环: 1/2 → 2/3 → 5/6) |
| `⌃⌥ →` | 右半屏 (循环: 1/2 → 2/3 → 5/6) |
| `⌃⌥ ↑` | 上半屏 |
| `⌃⌥ ↵` | 最大化 (带边距) |
| `⌃⌥ ⌫` | 还原窗口 |
| `⌃⌥ C` | 窗口居中 |
| `⌃⌥ L` | 几乎最大化 (留边距) |
| `⌃⌥ ;` | 靠最左 (保持大小) |
| `⌃⌥ '` | 靠最右 (保持大小) |

### 四角定位

| 快捷键 | 功能 |
|--------|------|
| `⌃⌥ U` | 左上 1/4 |
| `⌃⌥ I` | 右上 1/4 |
| `⌃⌥ 0` | 左下 1/4 |
| `⌃⌥ 2` | 右下 1/4 |

### 三分屏

| 快捷键 | 功能 |
|--------|------|
| `⌃⌥ ,` | 左 1/3 (循环: 左→中→右) |
| `⌃⌥ .` | 右 1/3 (循环: 右→中→左) |

### 窗口大小调整

| 快捷键 | 功能 |
|--------|------|
| `⌃⌥ =` | 增大窗口 |
| `⌃⌥ -` | 缩小窗口 |

### 显示器切换

| 快捷键 | 功能 |
|--------|------|
| `⌃⌥⇧ ←` | 移到左侧显示器 |
| `⌃⌥⇧ →` | 移到右侧显示器 |
| `⌃⌥⇧ ↑` | 最大化高度 |

### Edge Dock（边缘窗口坞）

屏幕右侧常驻 5 个小条，用于快速暂存和查看窗口。

**停靠窗口：**
| 快捷键 | 功能 |
|--------|------|
| `⌃⌥ 1` | 将当前窗口停靠到槽位 1 |
| `⌃⌥ 2` | 将当前窗口停靠到槽位 2 |
| `⌃⌥ 3` | 将当前窗口停靠到槽位 3 |
| `⌃⌥ 4` | 将当前窗口停靠到槽位 4 |
| `⌃⌥ 5` | 将当前窗口停靠到槽位 5 |

**恢复窗口：**
| 快捷键 | 功能 |
|--------|------|
| `⌃⌥⌘ 1` | 从槽位 1 恢复窗口 |
| `⌃⌥⌘ 2` | 从槽位 2 恢复窗口 |
| `⌃⌥⌘ 3` | 从槽位 3 恢复窗口 |
| `⌃⌥⌘ 4` | 从槽位 4 恢复窗口 |
| `⌃⌥⌘ 5` | 从槽位 5 恢复窗口 |

**Edge Dock 交互：**
- 鼠标靠近小条 → 窗口滑出显示
- 鼠标离开窗口 → 立即自动收回
- 同时只能显示一个窗口（单选模式）

### 工作区布局

| 快捷键 | 功能 |
|--------|------|
| `⌃⌥⌘ S` | 保存当前布局 |
| `⌃⌥⌘ R` | 恢复保存的布局 |
| `⌃⌥⌘ T` | 平铺当前应用所有窗口 |
| `⌃⌥⌘ O` | 恢复平铺前的布局 |

### 窗口移动（微调）

使用 `Cmd + Option` + 方向键：

| 快捷键 | 功能 |
|--------|------|
| `⌘⌥ ←` | 窗口左移 |
| `⌘⌥ →` | 窗口右移 |
| `⌘⌥ ↑` | 窗口上移 |
| `⌘⌥ ↓` | 窗口下移 |

## Edge Dock 使用说明

### 什么是 Edge Dock？

屏幕右侧会显示 5 个小条，你可以把暂时不用的窗口"停靠"到那里：

```
┌────────────────────────────┐
│                       [W]  │  ← 槽位1：微信 (白色=有窗口)
│                            │     (空隙)
│                       [ ]  │  ← 槽位2：空 (暗色=可用)
│                            │     (空隙)
│                       [S]  │  ← 槽位3：Slack
│                            │     (空隙)
│                       [ ]  │  ← 槽位4：空
│                            │     (空隙)
│                       [T]  │  ← 槽位5：Telegram
└────────────────────────────┘
```

### 停靠窗口

1. 激活要停靠的窗口
2. 按 `⌃⌥ 1-5` 选择槽位
3. 窗口会滑到屏幕右侧边缘藏起来

### 查看停靠的窗口

- 鼠标靠近对应小条 → 窗口滑出
- 可以操作窗口（回复消息等）
- 鼠标离开窗口 → 立即自动收回

### 恢复窗口

按 `⌃⌥⌘ 1-5` 把窗口从 Dock 恢复出来，回到原来的位置和大小。

### 适用场景

- **即时通讯**：微信、Slack、Telegram 等需要快速查看但不需要一直显示的窗口
- **参考文档**：查阅资料时把浏览器页面临存
- **音乐播放**：Spotify、网易云音乐等

## 边距配置

窗口布局会自动留出边距，可以在 `init.lua` 中调整：

```lua
local margin = {
    left = 20,   -- 左侧边距（距离屏幕左边缘）
    right = 20,  -- 右侧边距（距离屏幕右边缘）
    inner = 30,  -- 中间边距（窗口之间的空隙）
}
```

## Edge Dock 配置

可以在 `init.lua` 中调整 Edge Dock 外观和行为：

```lua
config = {
    maxSlots = 5,       -- 槽位数量
    barWidth = 6,       -- 小条宽度
    barHeight = 230,    -- 小条高度
    barGap = 10,        -- 小条间距
    hideDelay = 0,      -- 自动收起延迟（秒），0表示立即收起
}
```

## 高级功能

### 恢复被藏的窗口

如果 Hammerspoon 崩溃或配置重载，可能有些窗口被藏在屏幕边缘。配置会在启动时自动检测并恢复这些窗口。

### 屏幕变化适配

连接/断开外接显示器时，Edge Dock 会自动重新定位。

## 故障排除

**Q: 鼠标卡死了/窗口乱跳？**
A: 重新加载 Hammerspoon 配置，或重启 Hammerspoon。

**Q: 窗口找不到了？**
A: 重新加载配置，会自动恢复被藏在边缘的窗口。

**Q: 小条不显示？**
A: 确保 Hammerspoon 有屏幕录制权限（系统设置 → 隐私与安全 → 屏幕录制）。

## 致谢

- [Rectangle](https://rectangleapp.com/) - 灵感来源
- [Hammerspoon](https://www.hammerspoon.org/) - 强大的 macOS 自动化工具
